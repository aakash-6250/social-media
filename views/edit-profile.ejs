<%- include('./partials/header') %>

  <%- include('./partials/nav') %>

    <div id="container" class="w-full h-min-[90vh] flex p-5">
      <div class="w-[70vw]">
        
      <p class="mx-[5vw] text-2xl font-bold mb-5 text-[#4D869C] ">Edit Profile</p>
        <div id="dp" class="bg-[#eef7ffc6] md:w-[60%] w-[90%] m-auto  h-[20vh] rounded-xl flex justify-between items-center p-4 mb-4">
          <div id="image" class="flex gap-3 items-center">
            <% if(user.profile){ %>
              <img src="/images/profile/<%= user.profile %>" alt="" class="rounded-full h-[17vh] w-[17vh]">
              <% }else{ %>
                <div id="user-profile" class="rounded-full h-[17vh] w-[17vh] bg-white p-4">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                    <path fill="none" d="M0 0h24v24H0z"></path>
                    <path
                      d="M20 22H4V20C4 17.2386 6.23858 15 9 15H15C17.7614 15 20 17.2386 20 20V22ZM12 13C8.68629 13 6 10.3137 6 7C6 3.68629 8.68629 1 12 1C15.3137 1 18 3.68629 18 7C18 10.3137 15.3137 13 12 13Z">
                    </path>
                  </svg>
                </div>
                <% } %>

                  <div id="user-details" class=" text-[#4D869C] hidden md:block">
                    <p>@<%= user.username %>
                    </p>
                    <p>
                      <%= user.name %>
                    </p>
                  </div>
          </div>
          <form action="/edit-profile/<%= user.username %>" method="post" enctype="multipart/form-data" id="profile-form">
            <input type="file" name="profile" id="profile-select" class="hidden">
          </form>
          <div id="profile-option" class="flex flex-col gap-3">
            <div id="user-details" class=" text-[#4D869C] block md:hidden">
              <p>
                <%= user.username %>
              </p>
              <p>
                <%= user.name %>
              </p>
            </div>
            <p id="change-photo-btn" class="bg-[#4D869C] text-white px-2 w-max py-2 cursor-pointer rounded-xl">Change
              Photo</p>
          </div>
        </div>

        <form action="/edit-profile/<%= user.username %>" method="post"
          class="md:w-[60%] w-[90%] h-full m-auto flex flex-col gap-4 items-center">
          <input class=" w-full px-5 py-2 rounded-md border-[#4D869C] border-2 " type="text" name="name" id=""
            placeholder="Enter name" value="<%= user.name %>">
          <input class=" w-full px-5 py-2 rounded-md border-[#4D869C] border-2 " type="text" name="username" id=""
            placeholder="Enter username" value="<%= user.username %>">
          <input class=" w-full px-5 py-2 rounded-md border-[#4D869C] border-2 " type="text" name="bio" id=""
            placeholder="bio" value="<%= user.bio %>">
          <input class=" w-full px-5 py-2 rounded-md border-[#4D869C] border-2 " type="password" name="oldpassword" id=""
            placeholder="Enter old password">
          <input class=" w-full px-5 py-2 rounded-md border-[#4D869C] border-2 " type="password" name="newpassword" id=""
            placeholder="Enter new password">

          <button class="bg-[#4D869C] text-white px-4 py-2 cursor-pointer rounded-xl w-min">Submit</button>

      </form>
      </div>

      <div class="pt-[10vh] underline text-[#4D869C]">
        <a href="/delete-account/<%= user._id %>">Delete account permanently</a>
      </div>
      <script>
        let changePhoto = document.querySelector('#profile-select');
        let profileForm = document.querySelector('#profile-form')
        let changePhotoBtn = document.querySelector('#change-photo-btn');
        changePhotoBtn.addEventListener('click', function () {
          changePhoto.click();
          changePhoto.addEventListener('change', () => {
          profileForm.submit();
        })
        })
      </script>

    </div>

    <%- include('./partials/footer') %>